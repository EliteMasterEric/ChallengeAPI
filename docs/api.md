# ChallengeAPI Documentation

A list of all the functions and data structures provided by ChallengeAPI to modders.

## ChallengeAPI.Goal

A Goal is a data structure representing the objective of a given challenge. It includes simple information about the challenge goals, and provides additional functions to fine-tune the path the player takes to achieve the goal. It also includes language information (for EID information) as well as an icon (for HUD display).

Aside from functionality provided by the base game, (end stage/boss, choosing Cathedral/Sheol, forcing Downpour, forcing Mega Satan), you can also fine-tune parameters about the challenge. For example, you can force specific stage types to appear on specific floors (e.g. force Basement 1 and 2 to both be Cellar).

Goals will automatically be assigned to vanilla challenges based on the parameters provided in the `challenges.xml` file. If you don't need customize your challenge's goal, you don't have to assign a goal to your challenge.

## ChallengeAPI:RegisterGoal
Register a new goal with the ChallengeAPI. ChallengeAPI already defines a set of goals for most combinations of parameters that work by default.

```lua
local goal = ChallengeAPI:RegisterGoal(id, name, endStage, altPath, secretPath, megaSatan)
```

**Parameters**

* `id` - The internal ID for the challenge goal. This should be an (ideally kebab-case) string that is unique to your mod.
    * If another goal with the same ID is registered, the new goal will override the old one.
* `name` - The English readable name of the challenge goal. Used for challenge descriptions.
* `endStage` - The `LevelStage` corresponding to the challenge goal. For example, `LevelStage.STAGE4_2` for Mom's Heart.
* `altPath` - The `ChallengeAPI.GoalAltPaths` enum value corresponding to the challenge goal.
    * For example, `ChallengeAPI.GoalAltPaths.DEVIL` to lock the player into Sheol, `ChallengeAPI.GoalAltPaths.ANGEL` to lock the player into Cathedral, etc.
* `secretPath` - The `ChallengeAPI.GoalSecretPaths` enum value corresponding to the challenge goal.
    * For example, `ChallengeAPI.GoalSecretPaths.NORMAL` to lock the player into the normal path, `ChallengeAPI.GoalSecretPaths.SECRET` to lock the player into the secret Repentance path, etc.
* `megaSatan` - Whether this challenge goal requires you to beat Mega Satan.
    * If `true`, automatically grants the Key Pieces and disables the Lamb/??? fight.

## ChallengeAPI:GetGoalById
Retrieve a challenge goal by its ID.

```lua
local goal = ChallengeAPI:GetGoalById(id)
```

**Parameters**

* `id` - The internal ID for the challenge goal, as defined when it was registered.

**Returns**

* The `Goal` corresponding to the ID, or `nil` if no goal with that ID exists.

## ChallengeAPI:GetGoalByChallengeParams
Retrieve a challenge goal by finding the first one with matching challenge parameters.

```lua
local goal = ChallengeAPI:GetGoalByChallengeParams(endStage, altPath, secretPath, megaSatan)
```

**Parameters**

* `endStage` - The `LevelStage` corresponding to the challenge goal.
* `altPath` - The `ChallengeAPI.GoalAltPaths` enum value corresponding to the challenge goal.
* `secretPath` - The `ChallengeAPI.GoalSecretPaths` enum value corresponding to the challenge goal.
* `megaSatan` - Whether this challenge goal requires you to beat Mega Satan.

**Returns**

* The `Goal` corresponding to the challenge parameters, or `nil` if no goal with those parameters exists.

# ChallengeAPI.ChallengeParams

A ChallengeParams is a data structure representing a playable challenge. It provides a set of functions for interacting with the challenge's parameters, including the goal and other information.

ChallengeAPI will automatically register each challenge from the `challenges.xml` file, and define their basic parameters.

If you want to change the goal for a challenge, retrieve it using `ChallengeAPI:GetChallengeById` or `ChallengeAPI:GetChallengeByName`, and then use `ChallengeParams:SetGoal` to set a new goal. Don't modify the goal directly or you may mess up other challenges!

## ChallengeAPI:GetChallengeByName
Retrieve a challenge by its English name, as defined in the `challenges.xml` file.

```lua
local challenge = ChallengeAPI:GetChallengeByName(name)
```

**Parameters**

* `name` - The name for the challenge, as defined in the `challenges.xml` file.

**Returns**

* The `ChallengeParams` corresponding to the name, or `nil` if no challenge with that name exists.

## ChallengeAPI:GetChallengeById
Retrieve a challenge by its numeric ID, as auto-generated by the game.

```lua
local challenge = ChallengeAPI:GetChallengeById(id)
```

**Parameters**

* `id` - The numeric ID for the challenge, as defined in the `challenges.xml` file.

**Returns**

* The `ChallengeParams` corresponding to the ID, or `nil` if no challenge with that ID exists.

## ChallengeParams:SetGoal

Modifies the challenge goal for this challenge. This changes how the challenge is displayed on the HUD as well as certain game parameters.

```lua
local challenge = ChallengeAPI:GetChallengeById("my-custom-challenge")
local goal = ChallengeAPI:GetGoalById("my-custom-goal")
challenge:SetGoal(goal)
```

**REPENTOGON ONLY:** You can also set the goal for a challenge using the XML file! SetGoal will automatically be called for you. This method is preferred as it helps keep your challenge data self-documenting. *Make sure your mod has Repentogon as a dependency if you plan on using this feature.*

```xml
<!-- Make sure your endstage and other parameters are still correct! -->
<challenge name="My Custom Challenge" startingitems="123,456" endstage="6" capigoal="my-custom-goal" />
```

**Parameters**

* `goal` - The `Goal` to set for this challenge.
